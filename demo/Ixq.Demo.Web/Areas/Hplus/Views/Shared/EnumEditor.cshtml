@using Ixq.Extensions
@model IPropertyEditModel
@{
    var isHasFlags = Model.EntityProperty.PropertyType.HasAttribute<FlagsAttribute>();
    var enumItem = TypeExtensions.GetEnumItems(Model.EntityProperty.PropertyType);
}
<div class="form-group">
    <label class="col-sm-3 control-label">@Model.EntityProperty.Name：</label>
    <div class="col-sm-8">
        @if (isHasFlags)
        {
            var i = 0;
            foreach (var item in enumItem)
            {
                <div class="checkbox checkbox-inline">
                    <input class="@(Model.EntityProperty.PropertyInfo.Name)" type="checkbox" id="@(Model.EntityProperty.PropertyInfo.Name)_@i" value="@item.Value" />
                    <label for="@(Model.EntityProperty.PropertyInfo.Name)_@i"> @item.Name </label>
                </div>
                i++;
            }
            <input type="hidden" id="@(Model.EntityProperty.PropertyInfo.Name)" name="@(Model.EntityProperty.PropertyInfo.Name)" value="@Model.Value.ToString()" />
            @Html.Script(
                @<script>
                     $(document).ready(function() {
                         var hideValue = $('#@(Model.EntityProperty.PropertyInfo.Name)');
                         var checkBoxList = $('input[type="checkbox"][class="@(Model.EntityProperty.PropertyInfo.Name)"]');
                         checkBoxList.change(function() {
                             var num = 0;
                             checkBoxList.each(function(index, element) {
                                 if (element.checked)
                                     num += new Number(element.value);
                             });
                             hideValue.val(num);
                         });
                     });
                </script>
            )
        }
        else
        {
            <select class="form-control" name="@Model.EntityProperty.PropertyInfo.Name" @Html.Raw(Model.EntityProperty.IsRequired ? "required=\"\"" : "")>
                @if (!Model.EntityProperty.IsRequired)
                {
                    <option>请选择</option>
                }
                @foreach (var item in enumItem)
                {
                    <option value="@item.Value">@item.Name</option>
                }
            </select>
        }
    </div>
</div>